Kiwi.Plugins.SaveGame={name:"SaveGame",version:"1.0.1"},Kiwi.PluginManager.register(Kiwi.Plugins.SaveGame),Kiwi.Plugins.SaveGame.create=function(a){var b=new Kiwi.Plugins.SaveGame.SaveManager(a);return a.saveManager=b,a.saveManager},Kiwi.Plugins.SaveGame.SaveManager=function(a){this.game=a},Kiwi.Plugins.SaveGame.SaveManager.prototype.objType=function(){return"SaveManager"},Kiwi.Plugins.SaveGame.SaveManager.prototype.boot=function(){this.localStorage=new Kiwi.Plugins.SaveGame.LocalStorage(this.game),this.current=this.localStorage},Kiwi.Plugins.SaveGame.SaveManager.prototype.switchCurrent=function(a){if("undefined"!=typeof a)switch(a){case Kiwi.Plugins.SaveGame.SaveManager.LOCAL_STORAGE:this.current=this.localStorage}},Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"add",{get:function(){return this.current.add.bind(this.current)},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"edit",{get:function(){return this.current.edit.bind(this.current)},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"remove",{get:function(){return this.current.delete.bind(this.current)},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"getData",{get:function(){return this.current.getData.bind(this.current)},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"save",{get:function(){return this.current.save.bind(this.current)},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.SaveManager.prototype,"exists",{get:function(){return this.current.exists.bind(this.current)},enumerable:!0,configurable:!0}),Kiwi.Plugins.SaveGame.SaveManager.LOCAL_STORAGE=1,Kiwi.Plugins.SaveGame.LocalStorage=function(a){this.game=a,this._data={},this._supported=Kiwi.DEVICE.localStorage,this.supported&&this._retrieveData()},Object.defineProperty(Kiwi.Plugins.SaveGame.LocalStorage.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(Kiwi.Plugins.SaveGame.LocalStorage.prototype,"supported",{get:function(){return this._supported},enumerable:!0,configurable:!0}),Kiwi.Plugins.SaveGame.LocalStorage.prototype.objType=function(){return"LocalStorage"},Kiwi.Plugins.SaveGame.LocalStorage.prototype._retrieveData=function(){if(null!==localStorage.getItem(this.game.stage.name)){var a=localStorage.getItem(this.game.stage.name);this._data=JSON.parse(a)}else this._create()},Kiwi.Plugins.SaveGame.LocalStorage.prototype._create=function(){try{this._data={name:this.game.stage.name},localStorage.setItem(this.game.stage.name,JSON.stringify(this._data))}catch(a){console.log("Can not use localstorage due to memory limitations."),this._supported=!1}},Kiwi.Plugins.SaveGame.LocalStorage.prototype.add=function(a,b,c){if("undefined"==typeof c&&(c=!1),this.supported===!0){if(this._data[a]=b,c!==!0)return!0;this.save()}return!1},Kiwi.Plugins.SaveGame.LocalStorage.prototype.edit=function(a,b,c){if("undefined"==typeof c&&(c=!1),this.supported===!0&&null!==this._data[a]){if(this._data[a]=b,c!==!0)return!0;this.save()}return!1},Kiwi.Plugins.SaveGame.LocalStorage.prototype.getData=function(a){return this.supported===!0&&this._data[a]?this._data[a]:null},Kiwi.Plugins.SaveGame.LocalStorage.prototype.exists=function(a){return void 0!==this._data[a]},Kiwi.Plugins.SaveGame.LocalStorage.prototype.remove=function(a,b){if("undefined"==typeof b&&(b=!1),this.supported===!0&&null!==this._data[a]){if(delete this._data[a],b!==!0)return!0;this.save()}},Kiwi.Plugins.SaveGame.LocalStorage.prototype.clear=function(a){"undefined"==typeof a&&(a=!1),this.supported===!0&&(this._data={},a===!0&&this.save())},Kiwi.Plugins.SaveGame.LocalStorage.prototype.save=function(){try{return localStorage.setItem([this.game.stage.name],JSON.stringify(this._data)),!0}catch(a){return console.log("Localstorage is full. Could not update."),!1}},Kiwi.Plugins.SaveGame.LocalStorage.prototype.load=function(){return this.supported===!0?(this._data=JSON.parse(localStorage.getItem(this.game.stage.name)),!0):!1};